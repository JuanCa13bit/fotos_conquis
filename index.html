<!DOCTYPE html>
<html>
<head>
    <title>Sube tu Foto - Club Conquistadores</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <style>
        /* COLORES DE CONQUISTADORES: Azul y Amarillo */
        body { font-family: Arial, sans-serif; background-color: #004d9c; color: #ffffff; text-align: center; padding: 20px; }
        h1 { color: #ffcc00; margin-top: 50px; }
        p { font-size: 1.1em; margin-bottom: 30px; }
        #upload_widget { background-color: #ffcc00; color: #004d9c; border: none; padding: 15px 30px; font-size: 16px; font-weight: bold; cursor: pointer; border-radius: 8px; }
        #upload_widget:hover { background-color: #ff9900; }
    </style>
</head>
<body>
    <h1>¡Sube tu foto de Conquis aqui! ⚜️</h1>
    <p>Haz clic en el boton, selecciona tu imagen y compartela con nosotros para la pagina de Instagram.</p>

    <button id="upload_widget" class="cloudinary-button">Subir Foto Ahora</button>

    <script type="text/javascript">
        // TUS CREDENCIALES
        const CLOUD_NAME = "dwvfvatr8"; 
        const UPLOAD_PRESET = "fotos_qr_conquis";

        function openCloudinaryUpload() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = async (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', UPLOAD_PRESET);

                document.getElementById('upload_widget').innerText = "Subiendo...";
                
                try {
                    const response = await fetch(
                        `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/upload`,
                        {
                            method: 'POST',
                            body: formData,
                            // AÑADIMOS EL HEADER EXPLÍCITO DE ORIGEN (CORS)
                            headers: {
                                'Access-Control-Allow-Origin': 'https://juanca13bit.github.io'
                            }
                        }
                    );

                    if (response.ok) {
                        alert("Subida exitosa. ¡Gracias por tu lealtad! ⚜️");
                    } else if (response.status === 401) {
                         alert("Error 401 (No autorizado). El dominio no está permitido en Cloudinary.");
                    } else {
                        alert("Error al subir la foto. Código: " + response.status);
                    }
                } catch (error) {
                    alert("Hubo un error de conexión.");
                } finally {
                    document.getElementById('upload_widget').innerText = "Subir Foto Ahora";
                }
            };
            
            input.click();
        }

        document.getElementById("upload_widget").addEventListener("click", openCloudinaryUpload);
    </script>
</body>
</html>
